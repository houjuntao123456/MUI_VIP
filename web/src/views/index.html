<title>首页</title>

<div class="layui-card layadmin-header">
	<div class="layui-breadcrumb" lay-filter="breadcrumb">
		<a lay-href="">HOME</a>
		<a>
			<cite>首页</cite>
		</a>
	</div>
</div>

<div class="layui-fluid">
	<div class="layui-row layui-col-space15">
		<div class="layui-col-md12">
			<div class="layui-row layui-col-space15">
				<div class="layui-col-md6">
					<div class="layui-card">
						<div class="layui-card-header">快捷方式</div>
						<div class="layui-card-body">
							<div class="layui-carousel layadmin-carousel layadmin-shortcut">
								<div carousel-item>
									<ul class="layui-row layui-col-space10">
										<li class="layui-col-xs3">
											<a lay-href="crm/vip/viplist">
												<i class="layui-icon layui-icon-username"></i>
												<cite>会员列表</cite>
											</a>
										</li>
										<li class="layui-col-xs3">
											<a lay-href="crm/vip/vipinfo">
												<i class="layui-icon layui-icon-survey"></i>
												<cite>会员档案</cite>
											</a>
										</li>
										<li class="layui-col-xs3">
											<a lay-href="crm/viprig/">
												<i class="layui-icon layui-icon-diamond"></i>
												<cite>会员级别</cite>
											</a>
										</li>
										<li class="layui-col-xs3">
											<a lay-href="stm/store/organization">
												<i class="layui-icon layui-icon-templeate-1"></i>
												<cite>组织机构</cite>
											</a>
										</li>
										<li class="layui-col-xs3">
											<a lay-href="pro/extend/">
												<i class="layui-icon layui-icon-note"></i>
												<cite>商品标签</cite>
											</a>
										</li>
										<li class="layui-col-xs3">
											<a lay-href="crm/vip/viplabel">
												<i class="layui-icon layui-icon-tabs"></i>
												<cite>会员标签</cite>
											</a>
										</li>
										<li class="layui-col-xs3">
											<a lay-href="stm/store/list">
												<i class="layui-icon layui-icon-list"></i>
												<cite>门店列表</cite>
											</a>
										</li>
										<li class="layui-col-xs3">
											<a lay-href="stm/staff/sfpersonnel">
												<i class="layui-icon layui-icon-group"></i>
												<cite>员工列表</cite>
											</a>
										</li>
									</ul>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="layui-col-md6">
					<div class="layui-card">
						<div class="layui-card-header">当日提醒</div>
						<div class="layui-card-body">

							<div class="layui-carousel layadmin-carousel layadmin-backlog">
								<div carousel-item>
									<ul class="layui-row layui-col-space10">
										<li class="layui-col-xs6">
											<a lay-href="pro/commodity/salelist" class="layadmin-backlog-body">
												<h3>销售额</h3>
												<p><cite id="Salesvolume">0</cite></p>
											</a>
										</li>
										<li class="layui-col-xs6">
											<a href="javascript:;" class="layadmin-backlog-body">
												<h3>销售数量</h3>
												<p><cite id="Salesparts">0</cite></p>
											</a>
										</li>
										<li class="layui-col-xs6">
											<a href="javascript:;" class="layadmin-backlog-body">
												<h3>开卡数量</h3>
												<p><cite id="cards">0</cite></p>
											</a>
										</li>
										<li class="layui-col-xs6">
											<a href="javascript:;" class="layadmin-backlog-body">
												<h3>生日人数</h3>
												<p><cite id="Birthday">0</cite></p>
											</a>
										</li>
									</ul>
									<ul class="layui-row layui-col-space10">
										<li class="layui-col-xs6">
											<a lay-href="vip/returnorde/returnprogram" class="layadmin-backlog-body">
												<h3>返单计划待审核</h3>
												<p><cite id="returnjh">0</cite></p>
											</a>
										</li>
										<li class="layui-col-xs6">
											<a lay-href="vip/returnorde/interactive" class="layadmin-backlog-body">
												<h3>返单互动待审核</h3>
												<p><cite id="ReturnInteraction">0</cite></p>
											</a>
										</li>
										<li class="layui-col-xs6">
											<a href="javascript:;" class="layadmin-backlog-body">
												<h3>返单互动提醒</h3>
												<p><cite id="Returnreminder">0</cite></p>
											</a>
										</li>
										<!-- <li class="layui-col-xs6">
											<a href="javascript:;" class="layadmin-backlog-body">
												<h3>365互动提醒</h3>
												<p><cite id="Returnreminder365">0</cite></p>
											</a>
										</li> -->

									</ul>
									<!-- <ul class="layui-row layui-col-space10">
										<li class="layui-col-xs6">
											<a href="javascript:;" class="layadmin-backlog-body">
												<h3>回头互动提醒</h3>
												<p><cite id="Returback">0</cite></p>
											</a>
										</li>
									</ul> -->
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="layui-col-md12">
					<div class="layui-card">
						<div class="layui-card-header">数据概览</div>
						<div class="layui-card-body">

							<div class="layui-carousel layadmin-carousel layadmin-dataview" data-anim="fade" lay-filter="LAY-index-dataview">
								<div carousel-item id="LAY-index-dataview">
									<div><i class="layui-icon layui-icon-loading1 layadmin-loading"></i></div>
									<div></div>
									<!-- <div></div> -->
								</div>
							</div>

						</div>
					</div>
					<div class="layui-card">
						<div class="layui-card-header">数据概览</div>
						<div class="layui-card-body">
							<div class="layui-carousel layadmin-carousel layadmin-dataview" data-anim="fade" lay-filter="VIP-index-dataview">
								<div carousel-item id="VIP-index-dataview">
									<div><i class="layui-icon layui-icon-loading1 layadmin-loading"></i></div>
									<div></div>
								</div>
							</div>

						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<script>
	layui.use(['admin', 'element', 'carousel', 'echarts'], function () {
		var $ = layui.jquery
			, admin = layui.admin
			, carousel = layui.carousel
			, element = layui.element
			, echarts = layui.echarts
			, device = layui.device();
		element.render('progress');

		//轮播切换
		$('.layadmin-carousel').each(function () {
			var othis = $(this);
			carousel.render({
				elem: this
				, width: '100%'
				, arrow: 'none'
				, interval: othis.data('interval')
				, autoplay: othis.data('autoplay') === true
				, trigger: (device.ios || device.android) ? 'click' : 'hover'
				, anim: othis.data('anim')
			});
		});
		/////////////////// 图表1
		admin.req({
			url: '/index.php/webIndexConsumption/',
			type: 'post',
			done: function (res) {
				// console.log(res.data); return false;
				var echartsApp1 = [], options1 = [
					//今日流量趋势
					{
						title: {
							text: '销售额趋势(月)',
							x: 'center',
							textStyle: {
								fontSize: 14
							}
						},
						tooltip: {
							trigger: 'axis'
						},
						legend: {
							data: ['', '']
						},
						xAxis: [{
							type: 'category',
							boundaryGap: false,
							data: res.data.days
						}],
						yAxis: [{
							type: 'value'
						}],
						series: [{
							name: '消费额',
							type: 'line',
							smooth: true,
							itemStyle: { normal: { areaStyle: { type: 'default' } } },
							data: res.data.d
						}]
					}, {
						title: {
							text: '连带率趋势(月)',
							x: 'center',
							textStyle: {
								fontSize: 14
							}
						},
						tooltip: {
							trigger: 'axis'
						},
						legend: {
							data: ['', '']
						},
						xAxis: [{
							type: 'category',
							boundaryGap: false,
							data: res.data.days
						}],
						yAxis: [{
							type: 'value'
						}],
						series: [{
							name: '连带率',
							type: 'line',
							smooth: true,
							itemStyle: { normal: { areaStyle: { type: 'default' } } },
							data: res.data.Joint_rate
						}]
					}
				]

					, elemDataView1 = $('#LAY-index-dataview').children('div')
					, renderDataView1 = function (index) {
						echartsApp1[index] = echarts.init(elemDataView1[index], layui.echartsTheme);
						echartsApp1[index].setOption(options1[index]);
						window.onresize = echartsApp1[index].resize;
					};
				//没找到DOM，终止执行
				if (!elemDataView1[0]) return;
				renderDataView1(0);

				//监听数据概览轮播
				var carouselIndex = 0;
				carousel.on('change(LAY-index-dataview)', function (obj) {
					renderDataView1(carouselIndex = obj.index);
				});

				//监听侧边伸缩
				layui.admin.on('side', function () {
					setTimeout(function () {
						renderDataView1(carouselIndex);
					}, 300);
				});

				//监听路由
				layui.admin.on('hash(tab)', function () {
					layui.router().path.join('') || renderDataView1(carouselIndex);
				});
			}
		})

		///////////////////// 图表2
		admin.req({
			url: '/index.php/webIndexRechargeamount/',
			type: 'post',
			done: function (res) {
				var echartsApp2 = [], options2 = [
					//今日流量趋势
					{
						title: {
							text: '客单价趋势(月)',
							x: 'center',
							textStyle: {
								fontSize: 14
							}
						},
						tooltip: {
							trigger: 'axis'
						},
						legend: {
							data: ['', '']
						},
						xAxis: [{
							type: 'category',
							boundaryGap: false,
							data: res.data.days
						}],
						yAxis: [{
							type: 'value'
						}],
						series: [{
							name: '客单价',
							type: 'line',
							smooth: true,
							itemStyle: { normal: { areaStyle: { type: 'default' } } },
							data: res.data.k_price
						}]
					}, {
						title: {
							text: '件单价趋势(月)',
							x: 'center',
							textStyle: {
								fontSize: 14
							}
						},
						tooltip: {
							trigger: 'axis'
						},
						legend: {
							data: ['', '']
						},
						xAxis: [{
							type: 'category',
							boundaryGap: false,
							data: res.data.days
						}],
						yAxis: [{
							type: 'value'
						}],
						series: [{
							name: '件单价',
							type: 'line',
							smooth: true,
							itemStyle: { normal: { areaStyle: { type: 'default' } } },
							data: res.data.j_price
						}]
					}
				]
					, elemDataView2 = $('#VIP-index-dataview').children('div')
					, renderDataView2 = function (index) {
						echartsApp2[index] = echarts.init(elemDataView2[index], layui.echartsTheme);
						echartsApp2[index].setOption(options2[index]);
						//window.onresize = echartsApp2[index].resize;
					};
				//没找到DOM，终止执行
				if (!elemDataView2[0]) return;

				renderDataView2(0);

				//监听数据概览轮播
				var carouselIndex = 0;
				carousel.on('change(VIP-index-dataview)', function (obj) {
					renderDataView2(carouselIndex = obj.index);
				});

				//监听侧边伸缩
				layui.admin.on('side', function () {
					setTimeout(function () {
						renderDataView2(carouselIndex);
					}, 300);
				});

				//监听路由
				layui.admin.on('hash(tab)', function () {
					layui.router().path.join('') || renderDataView2(carouselIndex);
				});
			}
		});

		admin.req({ // 当日提醒的数据
			url: '/index.php/webIndexlist/',
			type: 'post',
			done: function (res) {
				$("#cards").html(res.data.open); //今日开卡数量  
				$("#Birthday").html(res.data.birt); //今日会员生日人数 
				$("#returnjh").html(res.data.list); //返单计划待审核数量
				$("#ReturnInteraction").html(res.data.rinter); //返单互动待审核数量
				$("#Salesvolume").html(res.data.Salesvolume); //销售额
				$("#Salesparts").html(res.data.Salesparts); //销售件
				$("#Returnreminder").html(res.data.Returnreminder); //返单互动 
				// $("#Returnreminder365").html(res.data.Returnreminder356); //365互动
				// $("#Returback").html(res.data.Returback); //回头互动
			}
		});
	});
</script>